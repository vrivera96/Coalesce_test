steps:
  STG_CMN_DEPARTMENT_BUSINESS_UNIT-7939ee3a-9760-40bb-9d6f-9a3e17b85b35:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: SERVICENOW_INCIDENTS_STORAGE
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 754f36c3-88d0-4b32-9b71-00a20d4451ae
              stepCounter: 7939ee3a-9760-40bb-9d6f-9a3e17b85b35
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: sys_id
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c6a8845f-5d0c-4918-b426-c50a9d9b4e3f
                    stepCounter: b66716da-494c-4100-9674-c7b51654d4cd
                transform: ""
          - columnReference:
              columnCounter: ecb35bb0-c386-4659-9548-cd283a7ff4dc
              stepCounter: 7939ee3a-9760-40bb-9d6f-9a3e17b85b35
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: DEPARTMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8f57d3a9-10c1-4932-be47-761d9b011c64
                    stepCounter: b66716da-494c-4100-9674-c7b51654d4cd
                transform: ""
          - columnReference:
              columnCounter: c327b7d2-c135-4adb-9037-47b523e69295
              stepCounter: 7939ee3a-9760-40bb-9d6f-9a3e17b85b35
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: AGENCY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1e64b870-8b35-4322-83aa-4612200c8498
                    stepCounter: e882539e-b114-4736-bbb4-91c03e374cd2
                transform: |-
                  CASE
                      WHEN "STG_CMN_DEPARTMENT"."name" = 'Economic Development' then 'Economic Development Agency'
                      ELSE "STG_BUSINESS_UNIT"."name"
                  END
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              STG_BUSINESS_UNIT: e882539e-b114-4736-bbb4-91c03e374cd2
              STG_CMN_DEPARTMENT: b66716da-494c-4100-9674-c7b51654d4cd
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: SERVICENOW_INCIDENTS_STORAGE
                nodeName: STG_BUSINESS_UNIT
              - locationName: SERVICENOW_INCIDENTS_STORAGE
                nodeName: STG_CMN_DEPARTMENT
            join:
              joinCondition: |-
                FROM {{ ref('SERVICENOW_INCIDENTS_STORAGE', 'STG_CMN_DEPARTMENT') }} "STG_CMN_DEPARTMENT"
                LEFT OUTER JOIN {{ ref('SERVICENOW_INCIDENTS_STORAGE', 'STG_BUSINESS_UNIT') }} "STG_BUSINESS_UNIT"
                ON "STG_CMN_DEPARTMENT"."business_unit_value" = "STG_BUSINESS_UNIT"."sys_id"
            name: STG_CMN_DEPARTMENT_BUSINESS_UNIT
            noLinkRefs: []
      name: STG_CMN_DEPARTMENT_BUSINESS_UNIT
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 7939ee3a-9760-40bb-9d6f-9a3e17b85b35
